<?xml version="1.0" encoding="utf-8"?><asx:abap version="1.0" xmlns:asx="http://www.sap.com/abapxml"><asx:values><VERSION>1</VERSION><TYPE/><INTERFACE href="#o3271"/><INTERFACET><FPINTERFACET><NAME/><STATE/><LANGUAGE>D</LANGUAGE><ID/><TEXT>Schnittstelle für Druck von Fakturabelegen</TEXT></FPINTERFACET><FPINTERFACET><NAME/><STATE/><LANGUAGE>E</LANGUAGE><ID/><TEXT>Interface for Printing Billing Documents</TEXT></FPINTERFACET><FPINTERFACET><NAME/><STATE/><LANGUAGE>S</LANGUAGE><ID/><TEXT>Interfase para imprimir documentos de facturación</TEXT></FPINTERFACET></INTERFACET></asx:values><asx:heap xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:abap="http://www.sap.com/abapxml/types/built-in" xmlns:cls="http://www.sap.com/abapxml/classes/global" xmlns:dic="http://www.sap.com/abapxml/types/dictionary"><cls:CL_FP_INTERFACE_DATA id="o3271"><CL_FP_INTERFACE_DATA classVersion="1"><CODING href="#o3275"/><PARAMETERS href="#o3274"/><GLOBAL_DEFINITIONS href="#o3273"/><REFERENCE_FIELDS href="#o3272"/><XSD_DEFINITIONS/></CL_FP_INTERFACE_DATA></cls:CL_FP_INTERFACE_DATA><cls:CL_FP_REFERENCE_FIELDS id="o3272"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o3271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_REFERENCE_FIELDS classVersion="1"><REFERENCE_FIELDS><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-VBDKR-NETWR</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-WAERK</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-VBDKR-BRGEW</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-GEWEI</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-VBDKR-NTGEW</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-GEWEI</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-VBDKR-VOLUM</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-VOLEH</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-KWERT</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-WAERK</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-KBETR</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-KOEI1</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-KBETR</VALUE><UNIT>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-KOEI1</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-KWERT</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-VBDKR-WAERK</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-NRMNG</VALUE><UNIT>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-KMEIN</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-NRMNG</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-KMEIN</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-KAWRT</VALUE><UNIT>BIL_PRT_COM-ITEM_DETAIL-CONDITIONS-AWEI1</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-KAWRT</VALUE><UNIT>BIL_PRT_COM-HEAD_DETAIL-CONDITIONS-AWEI1</UNIT></SFPREF></REFERENCE_FIELDS></CL_FP_REFERENCE_FIELDS></cls:CL_FP_REFERENCE_FIELDS><cls:CL_FP_GLOBAL_DEFINITIONS id="o3273"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o3271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_GLOBAL_DEFINITIONS classVersion="1"><GLOBAL_DATA><SFPGDATA><NAME>GV_LOGO</NAME><TYPING>TYPE</TYPING><TYPENAME>XSTRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_DATA</NAME><TYPING>TYPE</TYPING><TYPENAME>ZSDES_FACTURA_NC</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>ULINE</NAME><TYPING>TYPE</TYPING><TYPENAME>TDD_PRINT_ULINE</TYPENAME><DEFAULTVAL>'______________________________________________________________________________________________________________________________'</DEFAULTVAL><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_SWITCH</NAME><TYPING>TYPE</TYPING><TYPENAME>BOOLEAN</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA></GLOBAL_DATA><TYPES/><FIELDSYMBOLS/></CL_FP_GLOBAL_DEFINITIONS></cls:CL_FP_GLOBAL_DEFINITIONS><cls:CL_FP_PARAMETERS id="o3274"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o3271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_PARAMETERS classVersion="1"><IMPORT_PARAMETERS><SFPIOPAR><NAME>BIL_PRT_COM</NAME><TYPING>TYPE</TYPING><TYPENAME>INVOICE_S_PRT_INTERFACE</TYPENAME><OPTIONAL/><BYVALUE/><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR></IMPORT_PARAMETERS><EXPORT_PARAMETERS/><TABLE_PARAMETERS/><EXCEPTIONS/></CL_FP_PARAMETERS></cls:CL_FP_PARAMETERS><cls:CL_FP_CODING id="o3275"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o3271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_CODING classVersion="1"><INPUT_PARAMETERS><FPPARAMETER>GV_LOGO</FPPARAMETER><FPPARAMETER>BIL_PRT_COM</FPPARAMETER><FPPARAMETER>GS_DATA</FPPARAMETER></INPUT_PARAMETERS><OUTPUT_PARAMETERS><FPPARAMETER>GV_LOGO</FPPARAMETER><FPPARAMETER>GS_DATA</FPPARAMETER></OUTPUT_PARAMETERS><INITIALIZATION><FPCLINE>DATA: ls_adrs       TYPE addr1_sel,</FPCLINE><FPCLINE>      ls_posiciones TYPE zsdes_nc_prod,</FPCLINE><FPCLINE>      ls_spell      TYPE spell,</FPCLINE><FPCLINE>      lv_cantidad_1 TYPE char20,</FPCLINE><FPCLINE>      lv_cantidad_2 TYPE char2,</FPCLINE><FPCLINE>      lv_kposn      TYPE prcd_elements-kposn,</FPCLINE><FPCLINE>      lv_desc       TYPE prcd_elements-kwert,</FPCLINE><FPCLINE>      lv_decimals_2 TYPE p DECIMALS 2,</FPCLINE><FPCLINE>      lv_kwert_isv  TYPE prcd_elements-kwert,</FPCLINE><FPCLINE>      lv_isv        TYPE prcd_elements-kbetr,</FPCLINE><FPCLINE>      lv_name       TYPE stxbitmaps-tdname,</FPCLINE><FPCLINE>      lv_char_total TYPE char30.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>"BREAK nhernandez.</FPCLINE><FPCLINE/><FPCLINE>* Check the Segmentation switch</FPCLINE><FPCLINE>CALL METHOD cl_ops_switch_check=&gt;sfsw_segmentation</FPCLINE><FPCLINE>  RECEIVING</FPCLINE><FPCLINE>    rv_active = gv_switch.</FPCLINE><FPCLINE>IF gv_switch NE 'X'.</FPCLINE><FPCLINE>  CLEAR gv_switch.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE>*CLEAR gv_switch.</FPCLINE><FPCLINE/><FPCLINE>lv_name = 'LOGO_DIUNSA'.</FPCLINE><FPCLINE/><FPCLINE>CALL METHOD cl_ssf_xsf_utilities=&gt;get_bds_graphic_as_bmp</FPCLINE><FPCLINE>  EXPORTING</FPCLINE><FPCLINE>    p_object       = 'GRAPHICS'</FPCLINE><FPCLINE>    p_name         = lv_name      " Name of the SE78 logo inside Quotes</FPCLINE><FPCLINE>    p_id           = 'BMAP'</FPCLINE><FPCLINE>    p_btype        = 'BCOL' "for color, ‘BMON’ for Black &amp; White</FPCLINE><FPCLINE>  RECEIVING</FPCLINE><FPCLINE>    p_bmp          = gv_logo        " v_field and g_logo must be typed xstring</FPCLINE><FPCLINE>  EXCEPTIONS</FPCLINE><FPCLINE>    not_found      = 1</FPCLINE><FPCLINE>    internal_error = 2</FPCLINE><FPCLINE>    OTHERS         = 3.</FPCLINE><FPCLINE>IF sy-subrc NE 0.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>SELECT SINGLE * FROM t001 INTO @DATA(ls_t001)</FPCLINE><FPCLINE>  WHERE bukrs EQ @bil_prt_com-head_detail-tvko-bukrs.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE/><FPCLINE>  "nombre sociedad</FPCLINE><FPCLINE>  gs_data-header-nombre_sociedad = ls_t001-butxt.</FPCLINE><FPCLINE/><FPCLINE>  "direccion sociedad</FPCLINE><FPCLINE>  SELECT SINGLE * FROM adrc INTO @DATA(ls_adrc)</FPCLINE><FPCLINE>    WHERE addrnumber EQ @ls_t001-adrnr.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    CONCATENATE ls_adrc-str_suppl1 ls_adrc-street ls_adrc-house_num1</FPCLINE><FPCLINE>    INTO gs_data-header-direcc_sociedad</FPCLINE><FPCLINE>    SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>    "tel sociedad</FPCLINE><FPCLINE>    gs_data-header-tel_sociedad = ls_adrc-tel_number.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "rtn sociedad</FPCLINE><FPCLINE>  SELECT SINGLE * FROM t001z INTO @DATA(ls_t001z)</FPCLINE><FPCLINE>    WHERE bukrs EQ @ls_t001-bukrs.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header-rtn_sociedad = ls_t001z-paval.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ls_adrs-addrnumber = ls_t001-adrnr.</FPCLINE><FPCLINE/><FPCLINE>  "email sociedad</FPCLINE><FPCLINE>  SELECT SINGLE * FROM adr6 INTO @DATA(ls_adrc6)</FPCLINE><FPCLINE>    WHERE addrnumber EQ @bil_prt_com-head_detail-vbdkr-adrnr.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header-email_sociedad = ls_adrc6-smtp_addr.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "cliente</FPCLINE><FPCLINE>  CONCATENATE bil_prt_com-head_detail-vbdkr-kunag bil_prt_com-head_detail-vbdkr-name1</FPCLINE><FPCLINE>  INTO gs_data-header-cliente</FPCLINE><FPCLINE>  SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  "cabecera 2</FPCLINE><FPCLINE/><FPCLINE>  "rtn</FPCLINE><FPCLINE>  SELECT SINGLE * FROM dfkkbptaxnum INTO @DATA(ls_taxnum)</FPCLINE><FPCLINE>    WHERE partner EQ @bil_prt_com-head_detail-vbdkr-kunag.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header_2-rtn = ls_taxnum-taxnum.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "Vendedor</FPCLINE><FPCLINE>  SELECT SINGLE * FROM vbpa INTO @DATA(ls_vbpa)</FPCLINE><FPCLINE>    WHERE vbeln EQ @bil_prt_com-head_detail-vbdkr-vbeln</FPCLINE><FPCLINE>    AND parvw EQ 'VE'</FPCLINE><FPCLINE>    AND kunnr EQ @bil_prt_com-head_detail-tvko-kunnr.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header_2-vendedor = ls_vbpa-lifnr.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  SELECT SINGLE * FROM adrc INTO @DATA(ls_adrc2)</FPCLINE><FPCLINE>    WHERE addrnumber EQ @bil_prt_com-head_detail-vbdkr-adrnr.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    "direccion</FPCLINE><FPCLINE>    CONCATENATE ls_adrc2-str_suppl1 ls_adrc2-street ls_adrc2-house_num1</FPCLINE><FPCLINE>    INTO gs_data-header-direcc_cliente</FPCLINE><FPCLINE>    SEPARATED BY space.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE>  "O_DE_COMPRA</FPCLINE><FPCLINE>  SELECT SINGLE * FROM vbkd INTO @DATA(ls_vbkd)</FPCLINE><FPCLINE>    WHERE vbeln EQ @bil_prt_com-head_detail-vbdkr-vbeln.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header_2-o_de_compra = ls_vbkd-bstkd.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "CONDICIONES</FPCLINE><FPCLINE>  SELECT SINGLE vtext FROM tvzbt INTO @DATA(lv_zterm_txt)</FPCLINE><FPCLINE>    WHERE spras EQ 'S'</FPCLINE><FPCLINE>    AND zterm  EQ @bil_prt_com-head_detail-vbdkr-zterm.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header_2-condiciones = lv_zterm_txt.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "CAUSA_DEV</FPCLINE><FPCLINE>  gs_data-header_2-causa_dev = bil_prt_com-head_detail-vbdkr-vsbed_bez.</FPCLINE><FPCLINE/><FPCLINE>  "NOTA_CRED</FPCLINE><FPCLINE>  SELECT SINGLE vtext FROM tvfkt INTO @DATA(lv_fkart_vtxt)</FPCLINE><FPCLINE>    WHERE fkart EQ @bil_prt_com-head_detail-vbdkr-fkart</FPCLINE><FPCLINE>    AND   spras EQ 'S'.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gs_data-header_2-nota_cred = lv_fkart_vtxt.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "FECHA_DE_NC</FPCLINE><FPCLINE>  CONCATENATE bil_prt_com-head_detail-vbdkr-fkdat+6(2) bil_prt_com-head_detail-vbdkr-fkdat+4(2) bil_prt_com-head_detail-vbdkr-fkdat(4)</FPCLINE><FPCLINE>  INTO gs_data-header_2-fecha_de_nc</FPCLINE><FPCLINE>  SEPARATED BY '/'.</FPCLINE><FPCLINE/><FPCLINE>  "Posicion</FPCLINE><FPCLINE>  CLEAR: ls_posiciones, lv_char_total, lv_isv, lv_kwert_isv, lv_desc.</FPCLINE><FPCLINE>  lv_kposn = '000010'.</FPCLINE><FPCLINE>  LOOP AT bil_prt_com-item_detail INTO DATA(ls_items).</FPCLINE><FPCLINE/><FPCLINE>    "ls_items-VBDPR.</FPCLINE><FPCLINE/><FPCLINE>    "Codigo de barras</FPCLINE><FPCLINE>    SELECT SINGLE * FROM mara INTO @DATA(ls_mara)</FPCLINE><FPCLINE>      WHERE matnr EQ @ls_items-vbdpr-matnr.</FPCLINE><FPCLINE>    IF sy-subrc EQ 0.</FPCLINE><FPCLINE>      ls_posiciones-cod_barra = ls_mara-ean11."eannr.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>    "CANTIDAD</FPCLINE><FPCLINE>    ls_posiciones-cantidad = ls_items-vbdpr-fkimg.</FPCLINE><FPCLINE/><FPCLINE>    "DESCRIPCION</FPCLINE><FPCLINE>    ls_posiciones-descripcion = ls_items-vbdpr-arktx.</FPCLINE><FPCLINE/><FPCLINE>    "CAUSA_DEV</FPCLINE><FPCLINE>    ls_posiciones-causa_dev = ls_items-vgtyp_text.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE>    SELECT * FROM prcd_elements INTO TABLE @DATA(lt_prcd_elements)</FPCLINE><FPCLINE>      WHERE knumv EQ @bil_prt_com-head_detail-vbdkr-knumv</FPCLINE><FPCLINE>      AND   kposn EQ @lv_kposn.</FPCLINE><FPCLINE>    IF sy-subrc EQ 0.</FPCLINE><FPCLINE/><FPCLINE>      "PRECIO</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO DATA(ls_prcd_elements)</FPCLINE><FPCLINE>      WITH KEY kschl = 'PR00'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        ls_posiciones-precio = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE/><FPCLINE>      "DES_Y_REB</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'HA00'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        ls_posiciones-des_y_reb = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'HB00'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        ls_posiciones-des_y_reb = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'RB00'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        ls_posiciones-des_y_reb = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'RD00'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        ls_posiciones-des_y_reb = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      IF ls_posiciones-des_y_reb IS INITIAL.</FPCLINE><FPCLINE>        ls_posiciones-des_y_reb = '0'.</FPCLINE><FPCLINE>      ELSE.</FPCLINE><FPCLINE>        lv_desc = lv_desc + ls_prcd_elements-kwert.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      "ISV</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'MWST'.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        lv_kwert_isv = lv_kwert_isv + ls_prcd_elements-kwert.</FPCLINE><FPCLINE>        "ls_posiciones-des_y_reb = ls_prcd_elements-kwert.</FPCLINE><FPCLINE>        lv_isv = ls_prcd_elements-kbetr.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE/><FPCLINE>      "VALOR</FPCLINE><FPCLINE>      READ TABLE lt_prcd_elements INTO ls_prcd_elements</FPCLINE><FPCLINE>      WITH KEY kschl = 'SKTO'.</FPCLINE><FPCLINE>      ls_posiciones-valor = ls_items-vbdpr-netwr.</FPCLINE><FPCLINE>      lv_decimals_2 = ls_posiciones-valor + lv_char_total.</FPCLINE><FPCLINE>      CONDENSE:  ls_posiciones-valor, ls_posiciones-precio.</FPCLINE><FPCLINE>      CONCATENATE 'L.' ls_posiciones-valor INTO ls_posiciones-valor SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>    APPEND ls_posiciones TO gs_data-producto.</FPCLINE><FPCLINE>    lv_kposn = lv_kposn + 10.</FPCLINE><FPCLINE>  ENDLOOP.</FPCLINE><FPCLINE/><FPCLINE>  lv_char_total = lv_decimals_2.</FPCLINE><FPCLINE/><FPCLINE>  IF lv_char_total IS INITIAL.</FPCLINE><FPCLINE>    gs_data-total = '0.00'.</FPCLINE><FPCLINE>    gs_data-total = lv_char_total.</FPCLINE><FPCLINE>  ELSEIF lv_char_total IS NOT INITIAL AND lv_kwert_isv IS NOT INITIAL.</FPCLINE><FPCLINE>    gs_data-total = lv_char_total + lv_kwert_isv.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  "lv_char_total = lv_decimals_2.</FPCLINE><FPCLINE>  "CONDENSE lv_char_total.</FPCLINE><FPCLINE>  SPLIT gs_data-total AT '.' INTO lv_cantidad_1 lv_cantidad_2.</FPCLINE><FPCLINE/><FPCLINE>  CONDENSE lv_char_total.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-total INTO gs_data-total SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-des_y_reb IS INITIAL.</FPCLINE><FPCLINE>    gs_data-des_y_reb = '0.00'.</FPCLINE><FPCLINE>  ELSEIF</FPCLINE><FPCLINE>    gs_data-des_y_reb = lv_desc.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-des_y_reb INTO gs_data-des_y_reb SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-exonerado IS INITIAL.</FPCLINE><FPCLINE>    gs_data-exonerado = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-exonerado INTO gs_data-exonerado SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-excento IS INITIAL.</FPCLINE><FPCLINE>    gs_data-excento = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-excento INTO gs_data-excento SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-gravado18% IS INITIAL.</FPCLINE><FPCLINE>    gs_data-gravado18% = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-gravado18% INTO gs_data-gravado18% SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-gravado15% IS INITIAL.</FPCLINE><FPCLINE>    gs_data-gravado15% = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-gravado15% INTO gs_data-gravado15% SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-sub_total IS INITIAL AND lv_char_total IS INITIAL.</FPCLINE><FPCLINE>    gs_data-sub_total = '0.00'.</FPCLINE><FPCLINE>  ELSEIF lv_char_total IS NOT INITIAL.</FPCLINE><FPCLINE>    gs_data-sub_total = lv_char_total.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-sub_total INTO gs_data-sub_total SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  "ISV_15%</FPCLINE><FPCLINE>  IF lv_isv EQ '15.000000000'.</FPCLINE><FPCLINE>    gs_data-isv_15% = lv_kwert_isv.</FPCLINE><FPCLINE>  ELSEIF lv_isv EQ '18.000000000'.</FPCLINE><FPCLINE>    gs_data-isv_18% = lv_kwert_isv.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-isv_15% IS INITIAL.</FPCLINE><FPCLINE>    gs_data-isv_15% = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-isv_15% INTO gs_data-isv_15% SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>  IF gs_data-isv_18% IS INITIAL.</FPCLINE><FPCLINE>    gs_data-isv_18% = '0.00'.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>  CONCATENATE 'L.' gs_data-isv_18% INTO gs_data-isv_18% SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>  CONDENSE lv_cantidad_1.</FPCLINE><FPCLINE>  CALL FUNCTION 'SPELL_AMOUNT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      amount    = lv_cantidad_1</FPCLINE><FPCLINE>*     CURRENCY  = ' '</FPCLINE><FPCLINE>*     FILLER    = ' '</FPCLINE><FPCLINE>      language  = 'S'</FPCLINE><FPCLINE>    IMPORTING</FPCLINE><FPCLINE>      in_words  = ls_spell</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      not_found = 1</FPCLINE><FPCLINE>      too_large = 2</FPCLINE><FPCLINE>      OTHERS    = 3.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    SELECT SINGLE * FROM tcurt INTO @DATA(lv_texto_moneda)</FPCLINE><FPCLINE>      WHERE spras EQ 'S'</FPCLINE><FPCLINE>      AND   waers EQ @bil_prt_com-head_detail-vbdkr-waers.</FPCLINE><FPCLINE>    IF sy-subrc EQ 0.</FPCLINE><FPCLINE>      IF bil_prt_com-head_detail-vbdkr-waers EQ 'HNL'.</FPCLINE><FPCLINE>        lv_texto_moneda-ltext = 'LEMPIRAS'.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>      CONCATENATE lv_cantidad_2 '\100' INTO lv_cantidad_2.</FPCLINE><FPCLINE>      CONCATENATE 'SON:' ls_spell-word lv_cantidad_2 lv_texto_moneda-ltext INTO gs_data-son_montos SEPARATED BY space.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>ENDIF.</FPCLINE></INITIALIZATION><FORMS/></CL_FP_CODING></cls:CL_FP_CODING></asx:heap></asx:abap>